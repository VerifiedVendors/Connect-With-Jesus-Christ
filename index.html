<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect to Jesus</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to bottom, #e0f7fa, #ffffff);
            color: #333;
            margin: 0;
            padding: 20px;
            text-align: center;
            transition: background-color 0.5s, color 0.5s;
            overflow-x: hidden;
        }
        .dark-mode {
            background: linear-gradient(to bottom, #263238, #000000);
            color: #f0f8ff;
        }
        #clock {
            font-size: 2.5em;
            margin-bottom: 25px;
            text-shadow: 0 0 10px rgba(0,0,0,0.3);
        }
        #connect-button {
            background-color: #4CAF50;
            color: white;
            padding: 15px 35px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            box-shadow: 0 0 25px yellow;
            transition: transform 0.3s ease;
        }
        #connect-button:hover { transform: scale(1.05); }
        #verse-display {
            opacity: 0;
            transition: opacity 2.5s ease-in-out;
            font-size: 1.6em;
            margin: 20px auto;
            padding: 20px;
            max-width: 90%;
            background: rgba(255,255,255,0.9);
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            line-height: 1.5;
        }
        .dark-mode #verse-display { background: rgba(0,0,0,0.6); }
        .fade-in { opacity: 1 !important; }
        #prayer-display {
            font-style: italic;
            margin-top: 15px;
            font-size: 1.3em;
            padding: 10px;
            background: rgba(255,255,255,0.7);
            border-radius: 8px;
            max-width: 80%;
            margin: 15px auto;
        }
        .dark-mode #prayer-display { background: rgba(255,255,255,0.1); }
        #amen-button { cursor: pointer; font-size: 2em; color: red; transition: all 0.3s; }
        #amen-button:hover { transform: scale(1.2); color: darkred; }
        #copy-button, #send-button, #lost-button {
            cursor: pointer;
            margin: 10px;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 14px;
        }
        #copy-button { background: #2196F3; }
        #send-button { background: #4CAF50; }
        #lost-button { background: #FF9800; }
        #mode-toggle {
            position: fixed;
            top: 10px;
            right: 10px;
            cursor: pointer;
            font-size: 1.8em;
            z-index: 100;
        }
        #audio-toggle {
            position: fixed;
            top: 10px;
            left: 10px;
            cursor: pointer;
            font-size: 1.8em;
            z-index: 100;
        }
        #volume-slider {
            position: fixed;
            top: 55px;
            left: 10px;
            width: 120px;
            z-index: 100;
        }
        #breathing-prompt {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            display: none;
            font-size: 1.1em;
            z-index: 5;
        }
        #visitor-counter { margin-top: 25px; font-size: 1.1em; opacity: 0.8; }
        header {
            background: linear-gradient(to right, #87CEEB, #ADD8E6);
            padding: 25px;
            margin: 0 0 30px 0;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        footer { margin-top: 50px; opacity: 0.7; font-size: 0.9em; }
        .particle { position: absolute; background: rgba(255,255,255,0.5); border-radius: 50%; pointer-events: none; animation: float 15s linear infinite; }
        @keyframes float { 0% { transform: translateY(100vh) rotate(0deg); } 100% { transform: translateY(-100px) rotate(360deg); } }
        #confetti-canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 1; }
    </style>
</head>
<body>
    <div id="audio-toggle">Music</div>
    <div id="mode-toggle">Day/Night</div>
    <input type="range" id="volume-slider" min="0" max="100" value="30">

    <header>
        <h1>Draw Near to Jesus</h1>
        <div id="clock"></div>
    </header>
    <button id="connect-button">Connect to God</button>
    <div id="verse-display"></div>
    <div id="prayer-display"></div>
    <span id="amen-button">Amen</span> <span id="amen-count">0 people said Amen today</span><br>
    <button id="copy-button">Copy Verse</button>
    <button id="lost-button">Feeling lost?</button>
    <button id="send-button">Send this verse to a friend</button>
    <div id="visitor-counter">You are the 1st soul to draw near today</div>
    <footer>John 3:16 - For God so loved the world...</footer>
    <div id="breathing-prompt">Take a slow breath and thank Jesus (4-7-8 breathing)</div>
    <canvas id="confetti-canvas"></canvas>

    <!-- YouTube Player (hidden but plays) -->
    <iframe id="youtube-player" width="1" height="1" 
        src="" 
        frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

    <script>
        // (All your existing verses, prayers, functions, etc. — unchanged)
        const verses = [ /* ← your full 150+ verse list from last version stays here */ ];
        const comfortingVerses = [ /* ← your comforting verses stay here */ ];
        const prayers = [ /* ← your prayer list stays here */ ];

        let currentVerse = {};
        let isSpecialMode = false;

        function updateClock() {
            const now = new Date();
            let hours = now.getHours() % 12 || 12;
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            const ampm = now.getHours() >= 12 ? 'PM' : 'AM';
            document.getElementById('clock').innerText = `${hours}:${minutes}:${seconds} ${ampm}`;
        }
        setInterval(updateClock, 1000);
        updateClock();

        function getRandomVerse() { return verses[Math.floor(Math.random() * verses.length)]; }
        function getRandomPrayer() { return prayers[Math.floor(Math.random() * prayers.length)]; }

        function showVerse(verse, isSpecial = false) {
            currentVerse = verse;
            const display = document.getElementById('verse-display');
            display.innerHTML = `<strong>${verse.book} ${verse.reference}:</strong><br>${verse.text}`;
            display.style.opacity = 0;
            setTimeout(() => display.classList.add('fade-in'), 100);
            document.getElementById('prayer-display').innerText = getRandomPrayer();

            if (isSpecial) {
                isSpecialMode = true;
                display.style.fontSize = '2em';
                display.style.color = 'gold';
                display.style.boxShadow = '0 0 20px gold';
            } else {
                isSpecialMode = false;
                display.style.fontSize = '';
                display.style.color = '';
                display.style.boxShadow = '';
            }
        }

        document.getElementById('connect-button').addEventListener('click', () => {
            isSpecialMode = false;
            showVerse(getRandomVerse());
            checkFirstClickConfetti();
        });

        document.getElementById('lost-button').addEventListener('click', () => {
            const comfort = comfortingVerses[Math.floor(Math.random() * comfortingVerses.length)];
            showVerse(comfort, true);
        });

        setInterval(() => { if (!isSpecialMode) showVerse(getRandomVerse()); }, 60000);

        // === MUSIC FIX (only part changed) ===
        const player = document.getElementById('youtube-player');
        const audioToggle = document.getElementById('audio-toggle');
        const volumeSlider = document.getElementById('volume-slider');
        const youtubeURL = "https://www.youtube.com/embed/M-zp8W_247k?autoplay=1&loop=1&playlist=M-zp8W_247k&controls=0&modestbranding=1&rel=0&start=0";

        let musicOn = false;

        audioToggle.addEventListener('click', () => {
            if (musicOn) {
                player.src = "";
                audioToggle.textContent = "Music";
                musicOn = false;
            } else {
                player.src = youtubeURL + "&volume=" + volumeSlider.value;
                audioToggle.textContent = "Music On";
                musicOn = true;
            }
        });

        volumeSlider.addEventListener('input', () => {
            if (musicOn) {
                player.src = youtubeURL + "&volume=" + volumeSlider.value;
            }
        });

        // (All the rest of your code — confetti, amen counter, particles, dark mode, etc. — stays exactly the same)
        // ... [your existing long script continues unchanged]

        showVerse(getRandomVerse());
    </script>
</body>
</html>
